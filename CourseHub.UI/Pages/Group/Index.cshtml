@page
@using CourseHub.UI.Services.Implementations.UserServices;
@model CourseHub.UI.Pages.Social.IndexModel
@{
    Layout = "_GroupLayout";

    var defaultAvatar = "if(this.src!='/img/User_Empty.png')this.src='/img/User_Empty.png'";

    ViewData[Global.TITLE] = "Conversations";
}

@section RelatedUsers {
    @foreach (var user in Model.RelatedUsers.Take(3))
    {
        if (user.Key != Model.Client.Id)
        {
            <a href="#" class="d-block text-reset mr-7 mr-lg-6">
                <div class="avatar avatar-sm avatar-online mb-3">
                    <img class="avatar-img" src="@user.Value.AvatarUrl" alt="Avatar" onerror="@defaultAvatar">
                </div>
                <div class="small">@user.Value.FullName</div>
            </a>
        }
    }
}

@section Conversations {
    @foreach (var conversation in Model.Conversations)
    {
        <a class="text-reset nav-link p-0 mb-6" asp-page="@Global.PAGE_GROUP_CONVERSATION" asp-route-id="@conversation.Id">
            <div class="card card-active-listener">
                <div class="card-body">
                    <div class="media">
                        <div class="avatar mr-5">
                            <img class="avatar-img" src="@conversation.AvatarUrl" alt="" onerror="@defaultAvatar">
                        </div>
                        <div class="media-body overflow-hidden">
                            <div class="d-flex align-items-center mb-1">
                                <h6 class="text-truncate mb-0 mr-auto">@conversation.Title</h6>
                                <!--<p class="small text-muted text-nowrap ml-4">10:42 am</p>-->
                            </div>
                            <!--<div class="text-truncate">Anna Bridges: Hey, Maher! How are you? The weather is great isn't it?</div>-->
                        </div>
                    </div>
                </div>

                <!--<div class="badge badge-circle badge-primary badge-border-light badge-top-right">
                    <span>3</span>
                </div>-->
            </div>
        </a>
    }
}

@section Main {
    <div class="main" data-mobile-height="">

        <!-- Default Page -->
        <div class="chat flex-column justify-content-center text-center">
            <div class="container-xxl">

                <div class="avatar avatar-lg mb-5">
                    <img class="avatar-img" src="@UserApiService.GetAvatarApiUrl(Model.Client.AvatarUrl, Model.Client.Id)" alt="" onerror="@defaultAvatar">
                </div>

                <h6>Hi, @Model.Client.FullName!</h6>
                <p>Please select a chat to start messaging.</p>
            </div>
        </div>
        <!-- Default Page -->

    </div>
}